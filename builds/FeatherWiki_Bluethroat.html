<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta name=viewport content="width=device-width,initial-scale=1"> <title>Feather Wiki</title> <meta name=description content="A lightweight quine for simple, self-contained wikis"> <meta name=version content=Bluethroat_1.3.0> <meta name=application-name content="Feather Wiki"> <style id=s>html{font-family:BlinkMacSystemFont,-apple-system,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif}html,button,input,select,option,textarea{font-size:12pt;background:#fff;color:#000}html,body{margin:0;padding:0}:focus{outline:2px solid #000}*{box-sizing:border-box;position:relative;max-width:100vw}*+*,p,.pell-content>*:not(:first-child){margin:.5rem 0}main>*{padding:1rem 1.5rem}#g:not([open]),.sb .n{display:none}input,select,textarea{padding:.5rem}.np{max-width:8rem}button,summary{text-align:center;color:#fff;padding:5px 12px;background-color:#65a;border:0;border-radius:1rem}a,button,summary,.noti{cursor:pointer}a{text-decoration:none;color:#65a}:is(a,button):is(:hover,:active,:visited){opacity:.8}a.e{color:red}a.l{visibility:hidden}:is(h1,h2,h3,h4,h5,h6):hover a.l,a.l:is(:focus,:active){visibility:visible}a:is([target="_blank"],.e):after{font-size:70%;vertical-align:top;margin-left:3px}a[target=_blank]:after{content:"\29c9"}a.e:after{content:"!"}nav ul{list-style:none}ul,ol{padding:0 0 0 1rem}label{display:block}blockquote{margin-left:2rem;padding-left:1rem;border-left:3px solid #888}.uc pre{font-size:80%;padding:1em;border-radius:6px;background-color:#eee;line-height:1.5}abbr[title]{cursor:help}.t{font-size:1.5rem;font-weight:700}.sb{background:#ddd}.w1,.w34,.w12,.w14,.r,main{width:100%}.tabs>*{border:2px solid #65A;border-bottom:0;border-radius:.5rem .5rem 0 0;margin:0}.a{background:#87C}@media (min-width:50rem){.r,main{display:table;border-spacing:1rem 0}.r.ns,main{border-spacing:0}.c,main>*{display:table-cell!important;vertical-align:top}.sb{width:20%;min-width:200px;max-width:500px;height:100vh;overflow-y:auto}.sb .n{display:unset}.sbt{display:none}.w34{width:75%}.w12{width:50%}.w13{width:33%}.w14{width:25%}body>footer{position:absolute;inset:auto 1.5rem 0}form,.mw,#g,input,select,textarea,.ed{max-width:1000px}.tr{text-align:right}.fr{float:right}}.sr{visibility:hidden;height:0;width:0;position:absolute}.tr:not(.ml){text-align:right}.fr:not(.ml){float:right}.chg,.del{background:red}.del{opacity:.8}.h,.del{font-size:.8rem}.db{display:block}.il{display:inline}.ib{display:inline-block}.at{vertical-align:top}.pb{margin:0 0 1.5rem!important}.uc a{text-decoration:underline}.notis{position:fixed;inset:1vw 40vw auto}.noti{padding:1em;box-shadow:3px 3px 5px #555}#g,input,select,textarea,.ed,.noti{border:1px solid #000;border-radius:3px}.ed *{margin:unset}.pell-content,textarea,#g,.g{width:100%;overflow-y:auto;padding:10px;margin:0 auto}.pell-content,textarea{height:50vh;min-height:300px;max-height:600px}:is(.pell-content,textarea,.uc) *{max-width:100%}.pell-actionbar{border-bottom:1px solid #000}.pell-button{background:transparent;color:#000;vertical-align:middle}.pell-button-selected{background:#ddd} </style> </head> <body> <a href=https://codeberg.org/Alamantus/FeatherWiki#versions>JavaScript</a> is required <script id=p type=application/json>{}</script> <script id=a>(()=>{function G(a){var c=0,b;if(0===a.length)return c;for(b=0;b<a.length;b++){var h=a.charCodeAt(b);c=(c<<5)-c+h;c|=0}return c}function S(a,c){a=html`<input type=file accept=${a} onchange=${b=>{({files:b}=b.target);0<b.length&&c(b[0])}}>`;document.body.appendChild(a);a.click();document.body.removeChild(a)}function T(a){return a.replace(RegExp("^"+(a.match(/^(\t| )+/)||"")[0],"gm"),"")}function H(a){return(a+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function K(a,c){function b(v){var u=
U[v[1]||""],r=k[k.length-1]==v;return u?u[1]?(r?k.pop():k.push(v),u[0|r]):u[0]:v}function h(){for(var v="";k.length;)v+=b(k[k.length-1]);return v}var f,d,e,g=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,k=[],
n="",m=c||{},l=0;for(a=a.replace(/^\[(.+?)\]:\s*(.+)$/gm,function(v,u,r){return m[u.toLowerCase()]=r,""}).replace(/^\n+|\n+$/g,"");f=g.exec(a);){var q=a.substring(l,f.index);l=g.lastIndex;c=f[0];q.match(/[^\\](\\\\)*\\$/)||((e=f[3]||f[4])?c='<pre class="code '+(f[4]?"poetry":f[2].toLowerCase())+'"><code'+(f[2]?' class="language-'+f[2].toLowerCase()+'"':"")+">"+T(H(e).replace(/^\n+|\n+$/g,""))+"</code></pre>":(e=f[6])?(e.match(/\./)&&(f[5]=f[5].replace(/^\d+/gm,"")),d=K(T(f[5].replace(/^\s*[>*+.-]/gm,
""))),">"==e?e="blockquote":(e=e.match(/\./)?"ol":"ul",d=d.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),c="<"+e+">"+d+"</"+e+">"):f[8]?c='<img src="'+H(f[8])+'" alt="'+H(f[7])+'">':f[10]?(n=n.replace("<a>",'<a href="'+H(f[11]||m[q.toLowerCase()])+'">'),c=h()+"</a>"):f[9]?c="<a>":f[12]||f[14]?c="<"+(e="h"+(f[14]?f[14].length:"="<f[13]?1:2))+">"+K(f[12]||f[15],m)+"</"+e+">":f[16]?c="<code>"+H(f[16])+"</code>":(f[17]||f[1])&&(c=b(f[17]||"--")));n+=q;n+=c}return(n+a.substring(l)+h()).replace(/^\n+|\n+$/g,
"")}function sa(a){var c;return(null!=(c=a.match(/<.*?[_*].*?(?=>)|\[\[.+?\]\]/gs))?c:[]).forEach(b=>{a=a.replace(b,b.replace(/_/g,"\ufffe").replace(/\*/g,"\uffff").replace(/\[\[/g,"\ufffd").replace(/\]\]/g,"\ufffc"))}),a.split(/(?:\r?\n){2,}/).map(b=>" \t#-*>".split("").some(h=>b.startsWith(h))?K(b):`<p>${K(b)}</p>`).join("\n").replace(RegExp("\ufffe","g"),"_").replace(RegExp("\uffff","g"),"*").replace(RegExp("\ufffd","g"),"[[").replace(RegExp("\ufffc","g"),"]]")}function ta(a,c=()=>{}){!confirm("Inserting an image will increase your wiki's file size. Continue?")||
S("image/*",b=>{ua(b,(h,f,d)=>{if(h){let e=G(h);a.p.img[e.toString()]={alt:prompt("Set alt text",b.name),size:[f,d],img:h};c({img:h,id:e})}})})}function va(a,c,b=()=>{}){a.preventDefault();document.getElementById("g").close();b(c)}function ua(a,c=()=>{}){let b=new FileReader;b.onload=h=>{let f=new Image;f.src=h.target.result;f.onload=()=>{let d=document.createElement("canvas"),e=f.width,g=f.height,k=prompt("Set max width pixels:","400");k=null!=k&&k.length?parseInt(k):400;let n=prompt("Set max height pixels:",
"350");n=null!=n&&n.length?parseInt(n):350;e>g?e>k&&(g*=k/e,e=k):g>n&&(e*=n/g,g=n);d.width=e;d.height=g;d.getContext("2d").drawImage(f,0,0,e,g);c(d.toDataURL(a.type),e,g)}};b.onerror=h=>{c(null)};b.readAsDataURL(a)}function V(a,c,b){"boolean"==typeof c?(b=c,c=void 0):b="undefined"!=typeof b?b:!1;"undefined"==typeof c&&(I=-1);c=c||[];if(Array.isArray(a)){var h=b,f;b=0;for(f=a.length;b<f;b++)a[b]=V(a[b],c,h)}else{var d;c=W(X(a,c));!0===b&&(c=Y(c));b=JSON.stringify(a);f=c.length;for(d=0;d<f;d++)a=c[d],
b=b.replace(new RegExp('(?:"'+a[1].replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"):',"g"),'"'+a[0]+'":');a=(h=JSON.parse(b),h._=wa(c),h)}return a}function M(a){a=JSON.parse(JSON.stringify(a));if(Array.isArray(a)){var c;var b=0;for(c=a.length;b<c;b++)a[b]=M(a[b])}else{var h=JSON.parse(JSON.stringify(a._));delete a._;c=JSON.stringify(a);for(b in h)"undefined"!=typeof h[b]&&(c=c.replace(new RegExp('(?:"'+b+'"):',"g"),'"'+h[b]+'":'));h=c}return h?JSON.parse(h):a}function Z(a,c){var b,h=a.length;for(b=
0;b<h;b++)if(a[b][1]===c)return!0;return!1}function W(a){var c,b=a.length,h=[];for(c=0;c<b;c++)Z(h,a[c][1])||h.push(a[c]);return h}function wa(a){return a.reduce((c,b)=>(c[b[0]]=b[1],c),{})}function aa(a,c,b=0){var h=[];for(c=c||71;a>=c;)h.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=_!?()*".charCodeAt(a%c+b)),a=Math.floor(a/c-1);return h.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=_!?()*".charCodeAt(a+b)),h.reverse()}function X(a,c){var b,h,f;
for(h in a)"undefined"!=typeof a[h]&&(f=a[h],((null==f?void 0:f.constructor)===Object||Array.isArray(f))&&(c=c.concat(W(X(f,c)))),isNaN(Number(h))&&(Z(c,h)||(I+=1,b=[String.fromCharCode.apply(String,aa(I)),h],c.push(b))));return c}function Y(a){var c,b=a.length,h={};for(c=0;c<b;c++)h[a[c][0]]=c;for(c=0;c<b;c++){var f=a[c][1];if("undefined"!=typeof h[f])return c=h[f],I+=1,a[c][0]=String.fromCharCode.apply(String,aa(I)),h[c]=a[c][0],delete h[f],Y(a)}return a}function xa(a,c=()=>{}){let b=new FileReader;
b.onload=h=>ba(this,null,function*(){let f=h.target.result;var d=N(f,"script","p type=application/json");if(!d.length||"{"!==d[0])return alert("Could not find Feather Wiki data.");d=M(JSON.parse(d));d.img=yield ya(d.img);c([d,N(f,"style","c"),N(f,"script","j")])});b.onerror=function(h){c(null)};b.readAsText(a)}function N(a,c,b){b=`\\s<${c} id=${b}>`;a=a.match(new RegExp(b+`.+?(?=</${c}>)`,"s"));return(null!=a?a:[]).length?a[0].replace(b.replace("\\s",""),"").trim():""}function ya(a){return ba(this,
null,function*(){let c=Object.keys(a);return c.length&&!a[c[0]].img&&(yield Promise.all(c.map(b=>new Promise(h=>{let f=new Image;f.src=a[b];f.onload=()=>{a[b]={img:a[b],alt:"image",size:[f.width,f.height]};h()}})))),a})}function za(a,c){var b;let h=null!=a?a:null;return h&&(null!=(b=null==a?void 0:a.match(/\[\[.+?(?=\]\])/g))?b:[]).forEach(f=>{let d=f.replace("[[","").split("|"),e=d[1]?d[1].trim():F(d[0]),g=c.p.pages.some(k=>k.slug===e);h=h.replace(`${f}]]`,`<a href="${c.root}?page=${e}"${g?"":" class=e"}>${d[0]}</a>`)}),
h}function Aa(a,c,b=!1){var h;let f=null!=a?a:null;return f&&(null!=(h=null==a?void 0:a.match(/img:.+?(?=:img)/g))?h:[]).forEach(d=>{id=d.replace("img:","");let e=c.p.img[id];f=f.replace(`${d}:img`,e.img+(b?`#${id}`:"")+`" alt="${e.alt}`)}),f}function Ba(a){var c;let b=null!=a?a:null;return b&&(null!=(c=null==a?void 0:a.match(/<a href=".+?(?=")/gi))?c:[]).forEach(h=>{b=b.replace(h,`${h}" target="_blank" rel="noopener noreferrer`)}),b}function Ca(a){var c;let b=null!=a?a:null;return b&&(null!=(c=null==
a?void 0:a.match(/<h\d>.+?<\/h\d>/gi))?c:[]).forEach(h=>{let f=h.match(/<h(\d)>(.+)<\/h\d>/i),d=F(f[2]);b=b.replace(h,`<h${f[1]} id=${d}>${f[2]} <a class=l href=#${d}>#</a></h${f[1]}>`)}),b}function ca(a){let {a:c,s:b,c:h,p:f,j:d}=a;return`<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta name=viewport content="width=device-width,initial-scale=1"> <title>${f.name}</title> ${f.desc?`<meta name="description" content="${f.desc.replace(/"/g,'\\"')}">`:""} <meta name=version content=Bluethroat_1.3.0> <meta name=application-name content="Feather Wiki"> <style id=s>${b}</style> ${h?
`<style id=c>${h}</style>`:""} </head> <body> <a href=https://codeberg.org/Alamantus/FeatherWiki#versions>JavaScript is required</a> <script id=p type=application/json>${JSON.stringify(V(f))}<\/script> <script id=a>${c}<\/script> ${d?`<script id=j>${d}<\/script>`:""} </body> </html>`}function Da(a){a.use(Ea);a.use(Fa);a.use(c=>addEventListener("beforeunload",b=>{if(c.changed)return b.preventDefault(),b.returnValue="Lose unsaved changes?"},{capture:!0}));a.route("/:p",Ga);a.mount("body");window.choo=
a;window.html=Ha()}var Ia=Object.create,J=Object.defineProperty,Ja=Object.defineProperties,Ka=Object.getOwnPropertyDescriptor,La=Object.getOwnPropertyDescriptors,Ma=Object.getOwnPropertyNames,da=Object.getOwnPropertySymbols,Na=Object.getPrototypeOf,ea=Object.prototype.hasOwnProperty,Oa=Object.prototype.propertyIsEnumerable,fa=(a,c,b)=>c in a?J(a,c,{enumerable:!0,configurable:!0,writable:!0,value:b}):a[c]=b,L=(a,c)=>{for(var b in c||={})ea.call(c,b)&&fa(a,b,c[b]);if(da)for(b of da(c))Oa.call(c,b)&&
fa(a,b,c[b]);return a},O=(a,c)=>Ja(a,La(c)),E=(a,c)=>()=>(a&&(c=a(a=0)),c),z=(a,c)=>()=>(c||a((c={exports:{}}).exports,c),c.exports),ha=(a,c)=>{for(var b in c)J(a,b,{get:c[b],enumerable:!0})},ia=(a,c,b,h)=>{if(c&&"object"==typeof c||"function"==typeof c)for(let f of Ma(c))!ea.call(a,f)&&f!==b&&J(a,f,{get:()=>c[f],enumerable:!(h=Ka(c,f))||h.enumerable});return a},ja=(a,c,b)=>(b=null!=a?Ia(Na(a)):{},ia(!c&&a&&a.__esModule?b:J(b,"default",{value:a,enumerable:!0}),a)),ka=a=>ia(J({},"__esModule",{value:!0}),
a),ba=(a,c,b)=>new Promise((h,f)=>{var d=k=>{try{g(b.next(k))}catch(n){f(n)}},e=k=>{try{g(b.throw(k))}catch(n){f(n)}},g=k=>k.done?h(k.value):Promise.resolve(k.value).then(d,e);g((b=b.apply(a,c)).next())}),Pa=z((a,c)=>{c.exports=function(b,h){if(b)try{var f=document.querySelector(b);f&&f.scrollIntoView(h)}catch(d){}}}),Qa=z((a,c)=>{c.exports=function(b){if("undefined"==typeof document)throw Error("document-ready only runs in the browser");var h=document.readyState;if("complete"===h||"interactive"===
h)return setTimeout(b,0);document.addEventListener("DOMContentLoaded",function(){b()})}}),D=z((a,c)=>{function b(h,f){if(!h)throw Error(f||"AssertionError");}b.notEqual=function(h,f,d){b(h!=f,d)};b.notOk=function(h,f){b(!h,f)};b.equal=function(h,f,d){b(h==f,d)};b.ok=b;c.exports=b}),Ra=z((a,c)=>{function b(d){this.method=(this.hasIdle=(this.hasWindow=d)&&window.requestIdleCallback)?window.requestIdleCallback.bind(window):this.setTimeout;this.scheduled=!1;this.queue=[]}var h=D(),f="undefined"!=typeof window;
b.prototype.push=function(d){h.equal(typeof d,"function","nanoscheduler.push: cb should be type function");this.queue.push(d);this.schedule()};b.prototype.schedule=function(){if(!this.scheduled){this.scheduled=!0;var d=this;this.method(function(e){for(var g;d.queue.length&&0<e.timeRemaining();)g=d.queue.shift(),g(e);d.scheduled=!1;d.queue.length&&d.schedule()})}};b.prototype.setTimeout=function(d){setTimeout(d,0,{timeRemaining:function(){return 1}})};c.exports=function(){var d;return f?(window._nanoScheduler||
(window._nanoScheduler=new b(!0)),d=window._nanoScheduler):d=new b,d}}),la=z((a,c)=>{function b(g){function k(l){var q="end-"+n+"-"+g;e.mark(q);f.push(function(){var v=null;try{e.measure(g+" ["+n+"]",m,q),e.clearMarks(m),e.clearMarks(q)}catch(u){v=u}l&&l(v,g)})}if(d.equal(typeof g,"string","nanotiming: name should be type string"),b.disabled)return h;var n=(1E4*e.now()).toFixed()%Number.MAX_SAFE_INTEGER,m="start-"+n+"-"+g;e.mark(m);return k.uuid=n,k}function h(g){g&&f.push(function(){g(Error("nanotiming: performance API unavailable"))})}
var f=Ra()(),d=D();b.disabled=!0;try{var e=window.performance;b.disabled="true"===window.localStorage.DISABLE_NANOTIMING||!e.mark}catch(g){}c.exports=b}),Sa=z((a,c)=>{function b(){if(!(this instanceof b))return new b;this.trie={nodes:{}}}var h=D();c.exports=b;b.prototype.create=function(f){function d(g,k){var n=Object.prototype.hasOwnProperty.call(e,g)&&e[g];if(!1===n)return k;var m=null;return/^:|^\*/.test(n)?(Object.prototype.hasOwnProperty.call(k.nodes,"$$")?m=k.nodes.$$:(m={nodes:{}},k.nodes.$$=
m),"*"===n[0]&&(k.wildcard=!0),k.name=n.replace(/^:|^\*/,"")):Object.prototype.hasOwnProperty.call(k.nodes,n)?m=k.nodes[n]:(m={nodes:{}},k.nodes[n]=m),d(g+1,m)}h.equal(typeof f,"string","route should be a string");var e=f.replace(/^\//,"").split("/");return d(0,this.trie)};b.prototype.match=function(f){function d(k,n){if(void 0!==n){var m=e[k];if(void 0===m)return n;if(Object.prototype.hasOwnProperty.call(n.nodes,m))return d(k+1,n.nodes[m]);if(n.name){try{g[n.name]=decodeURIComponent(m)}catch(l){return d(k,
void 0)}return d(k+1,n.nodes.$$)}if(n.wildcard){try{g.wildcard=decodeURIComponent(e.slice(k).join("/"))}catch(l){return d(k,void 0)}return n.nodes.$$}return d(k+1)}}h.equal(typeof f,"string","route should be a string");var e=f.replace(/^\//,"").split("/"),g={};if(f=d(0,this.trie))return f=Object.assign({},f),f.params=g,f};b.prototype.mount=function(f,d){h.equal(typeof f,"string","route should be a string");h.equal(typeof d,"object","trie should be a object");f=f.replace(/^\//,"").split("/");var e=
null,g=null;if(1===f.length)g=f[0],e=this.create(g);else{var k=f.join("/");g=f[0];e=this.create(k)}Object.assign(e.nodes,d.nodes);d.name&&(e.name=d.name);e.nodes[""]&&(Object.keys(e.nodes[""]).forEach(function(n){"nodes"!==n&&(e[n]=e.nodes[""][n])}),Object.assign(e.nodes,e.nodes[""].nodes),delete e.nodes[""].nodes)}}),Ta=z((a,c)=>{function b(d){function e(l){var q=g(l),v=Array(arguments.length);v[0]=q.params;for(var u=1;u<v.length;u++)v[u]=arguments[u];return q.cb.apply(q.cb,v)}function g(l){h.notEqual(l,
void 0,"'route' must be defined");var q=m.match(l);if(q&&q.cb||(q=m.match(n))&&q.cb)return new k(q);throw Error("route '"+l+"' did not match");}function k(l){this.cb=l.cb;this.route=l.route;this.params=l.params}if(!(this instanceof b))return new b(d);var n=(d||"").replace(/^\//,""),m=f();return e._trie=m,e.on=function(l,q){if(h.equal(typeof l,"string"),h.equal(typeof q,"function"),l=l||"/",q._wayfarer&&q._trie)m.mount(l,q._trie.trie);else{var v=m.create(l);v.cb=q;v.route=l}return e},e.emit=e,e.match=
g,e._wayfarer=!0,e}var h=D(),f=Sa();c.exports=b}),Ua=z((a,c)=>{function b(l){if(!(this instanceof b))return new b(l);l=l||{};this.router=d(l.default||"/404")}function h(l,q){return q?l=l.replace(g,""):l=l.replace(k,""),decodeURI(l.replace(m,"").replace(n,"/"))}var f=D(),d=Ta(),e=/file:\/\//.test("object"==typeof window&&window.location&&window.location.origin),g=RegExp("^(file://|/)(.*.html?/?)?"),k=RegExp("^(http(s)?(://))?(www.)?[a-zA-Z0-9-_.]+(:[0-9]{1,5})?(/{1})?"),n=RegExp("#"),m=RegExp("[?].*$");
c.exports=b;b.prototype.on=function(l,q){f.equal(typeof l,"string");l=l.replace(/^[#/]/,"");this.router.on(l,q)};b.prototype.emit=function(l){return f.equal(typeof l,"string"),l=h(l,e),this.router.emit(l)};b.prototype.match=function(l){return f.equal(typeof l,"string"),l=h(l,e),this.router.match(l)}}),Va=z((a,c)=>{c.exports="onclick ondblclick onmousedown onmouseup onmouseover onmousemove onmouseout onmouseenter onmouseleave ontouchcancel ontouchend ontouchmove ontouchstart ondragstart ondrag ondragenter ondragleave ondragover ondrop ondragend onkeydown onkeypress onkeyup onunload onabort onerror onresize onscroll onselect onchange onsubmit onreset onfocus onblur oninput onanimationend onanimationiteration onanimationstart oncontextmenu onfocusin onfocusout".split(" ")}),
Wa=z((a,c)=>{function b(d,e,g){d[g]!==e[g]&&(e[g]=d[g],d[g]?e.setAttribute(g,""):e.removeAttribute(g))}var h=Va(),f=h.length;c.exports=function(d,e){var g=d.nodeType,k=d.nodeName;if(1===g){for(var n=e.attributes,m=d.attributes,l=null,q,v=null,u=null,r,p=m.length-1;0<=p;--p)r=m[p],u=r.name,l=r.namespaceURI,q=r.value,l?(u=r.localName||u,v=e.getAttributeNS(l,u),v!==q&&e.setAttributeNS(l,u,q)):e.hasAttribute(u)?(v=e.getAttribute(u),v!==q&&("null"===q||"undefined"===q?e.removeAttribute(u):e.setAttribute(u,
q))):e.setAttribute(u,q);for(m=n.length-1;0<=m;--m)r=n[m],!1!==r.specified&&(u=r.name,l=r.namespaceURI,l?(u=r.localName||u,d.hasAttributeNS(l,u)||e.removeAttributeNS(l,u)):d.hasAttributeNS(null,u)||e.removeAttribute(u))}3!==g&&8!==g||e.nodeValue===d.nodeValue||(e.nodeValue=d.nodeValue);"INPUT"===k?(g=d.value,k=e.value,b(d,e,"checked"),b(d,e,"disabled"),d.indeterminate!==e.indeterminate&&(e.indeterminate=d.indeterminate),"file"!==e.type&&(g!==k&&(e.setAttribute("value",g),e.value=g),"null"===g&&(e.value=
"",e.removeAttribute("value")),d.hasAttributeNS(null,"value")?"range"===e.type&&(e.value=g):e.removeAttribute("value"))):"OPTION"===k?b(d,e,"selected"):"TEXTAREA"===k&&(g=d.value,(g!==e.value&&(e.value=g),!e.firstChild||e.firstChild.nodeValue===g)||""===g&&e.firstChild.nodeValue===e.placeholder||(e.firstChild.nodeValue=g));for(g=0;g<f;g++)k=h[g],d[k]?e[k]=d[k]:e[k]&&(e[k]=void 0)}}),Xa=z((a,c)=>{function b(g,k){return k?g?g.isSameNode&&g.isSameNode(k)?k:g.tagName!==k.tagName||(g.dataset?g.dataset.nanomorphComponentId:
void 0)!==(k.dataset?k.dataset.nanomorphComponentId:void 0)?g:(e(g,k),h(g,k),k):null:g}function h(g,k){for(var n,m,l,q,v=0,u=0;n=k.childNodes[u],m=g.childNodes[u-v],n||m;u++)if(m)if(n)if(f(m,n))l=b(m,n),l!==n&&(k.replaceChild(l,n),v++);else{q=null;for(var r=u;r<k.childNodes.length;r++)if(f(k.childNodes[r],m)){q=k.childNodes[r];break}q?(l=b(m,q),l!==q&&v++,k.insertBefore(l,n)):m.id||n.id?(k.insertBefore(m,n),v++):(l=b(m,n),l!==n&&(k.replaceChild(l,n),v++))}else k.appendChild(m),v++;else k.removeChild(n),
u--}function f(g,k){return g.id?g.id===k.id:g.isSameNode?g.isSameNode(k):g.tagName!==k.tagName?!1:3===g.type?g.nodeValue===k.nodeValue:!1}var d=D(),e=Wa();c.exports=function(g,k,n){return d.equal(typeof g,"object","nanomorph: oldTree should be an object"),d.equal(typeof k,"object","nanomorph: newTree should be an object"),n&&n.childrenOnly?(h(k,g),g):(d.notEqual(k.nodeType,11,"nanomorph: newTree should have one root node (which is not a DocumentFragment)"),b(k,g))}}),Ya=z((a,c)=>{var b=/([^?=&]+)(=([^&]*))?/g,
h=D();c.exports=function(f){h.equal(typeof f,"string","nanoquery: url should be type string");var d={};return f.replace(/^.*\?/,"").replace(b,function(e,g,k,n){e=decodeURIComponent(n);g=decodeURIComponent(g);d.hasOwnProperty(g)?Array.isArray(d[g])?d[g].push(e):d[g]=[d[g],e]:d[g]=e}),d}}),Za=z((a,c)=>{var b=D(),h=/(noopener|noreferrer) (noopener|noreferrer)/,f=/^[\w-_]+:/;c.exports=function(d,e){b.notEqual(typeof window,"undefined","nanohref: expected window to exist");e=e||window.document;b.equal(typeof d,
"function","nanohref: cb should be type function");b.equal(typeof e,"object","nanohref: root should be type object");window.addEventListener("click",function(g){if(!(g.button&&0!==g.button||g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.defaultPrevented)){var k=function l(m){if(m&&m!==e)return"a"!==m.localName||void 0===m.href?l(m.parentNode):m}(g.target);!k||window.location.protocol!==k.protocol||window.location.hostname!==k.hostname||window.location.port!==k.port||k.hasAttribute("data-nanohref-ignore")||
k.hasAttribute("download")||"_blank"===k.getAttribute("target")&&h.test(k.getAttribute("rel"))||f.test(k.getAttribute("href"))||(g.preventDefault(),d(k))}})}}),$a=z((a,c)=>{var b=D();c.exports=function(h,f){b.equal(typeof h,"function","nanoraf: render should be a function");b.ok("function"==typeof f||"undefined"==typeof f,"nanoraf: raf should be a function or undefined");f||=window.requestAnimationFrame;var d=!1,e=null;return function(){null===e&&!d&&(d=!0,f(function(){d=!1;for(var g=e.length,k=Array(g),
n=0;n<g;n++)k[n]=e[n];h.apply(h,k);e=null}));e=arguments}}}),ab=z((a,c)=>{c.exports=function(b,h,f){var d=b.length;if(!(h>=d||0===f)){f=h+f>d?d-h:f;for(d-=f;h<d;++h)b[h]=b[h+f];b.length=d}}}),bb=z((a,c)=>{function b(e){if(!(this instanceof b))return new b(e);this._name=e||"nanobus";this._starListeners=[];this._listeners={}}var h=ab(),f=la(),d=D();c.exports=b;b.prototype.emit=function(e){d.ok("string"==typeof e||"symbol"==typeof e,"nanobus.emit: eventName should be type string or symbol");for(var g=
[],k=1,n=arguments.length;k<n;k++)g.push(arguments[k]);k=f(this._name+"('"+e.toString()+"')");n=this._listeners[e];return n&&0<n.length&&this._emit(this._listeners[e],g),0<this._starListeners.length&&this._emit(this._starListeners,e,g,k.uuid),k(),this};b.prototype.on=b.prototype.addListener=function(e,g){return d.ok("string"==typeof e||"symbol"==typeof e,"nanobus.on: eventName should be type string or symbol"),d.equal(typeof g,"function","nanobus.on: listener should be type function"),"*"===e?this._starListeners.push(g):
(this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(g)),this};b.prototype.prependListener=function(e,g){return d.ok("string"==typeof e||"symbol"==typeof e,"nanobus.prependListener: eventName should be type string or symbol"),d.equal(typeof g,"function","nanobus.prependListener: listener should be type function"),"*"===e?this._starListeners.unshift(g):(this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].unshift(g)),this};b.prototype.once=function(e,g){function k(){g.apply(n,
arguments);n.removeListener(e,k)}d.ok("string"==typeof e||"symbol"==typeof e,"nanobus.once: eventName should be type string or symbol");d.equal(typeof g,"function","nanobus.once: listener should be type function");var n=this;this.on(e,k);return this};b.prototype.prependOnceListener=function(e,g){function k(){g.apply(n,arguments);n.removeListener(e,k)}d.ok("string"==typeof e||"symbol"==typeof e,"nanobus.prependOnceListener: eventName should be type string or symbol");d.equal(typeof g,"function","nanobus.prependOnceListener: listener should be type function");
var n=this;this.prependListener(e,k);return this};b.prototype.removeListener=function(e,g){function k(n,m){if(n&&(m=n.indexOf(m),-1!==m))return h(n,m,1),!0}return(d.ok("string"==typeof e||"symbol"==typeof e,"nanobus.removeListener: eventName should be type string or symbol"),d.equal(typeof g,"function","nanobus.removeListener: listener should be type function"),"*"===e)?(this._starListeners=this._starListeners.slice(),k(this._starListeners,g)):("undefined"!=typeof this._listeners[e]&&(this._listeners[e]=
this._listeners[e].slice()),k(this._listeners[e],g))};b.prototype.removeAllListeners=function(e){return e?"*"===e?this._starListeners=[]:this._listeners[e]=[]:(this._starListeners=[],this._listeners={}),this};b.prototype.listeners=function(e){e="*"!==e?this._listeners[e]:this._starListeners;var g=[];if(e)for(var k=e.length,n=0;n<k;n++)g.push(e[n]);return g};b.prototype._emit=function(e,g,k,n){if("undefined"!=typeof e&&0!==e.length)for(void 0===k&&(k=g,g=null),g&&(void 0!==n?k=[g].concat(k,n):k=[g].concat(k)),
g=e.length,n=0;n<g;n++){var m=e[n];m.apply(m,k)}}}),cb=z((a,c)=>{function b(h){if(!(this instanceof b))return new b(h);"number"==typeof h&&(h={max:h});h||={};this.cache={};this.head=this.tail=null;this.length=0;this.max=h.max||1E3;this.maxAge=h.maxAge||0}c.exports=b;Object.defineProperty(b.prototype,"keys",{get:function(){return Object.keys(this.cache)}});b.prototype.clear=function(){this.cache={};this.head=this.tail=null;this.length=0};b.prototype.remove=function(h){if("string"!=typeof h&&(h=""+
h),this.cache.hasOwnProperty(h)){var f=this.cache[h];return delete this.cache[h],this._unlink(h,f.prev,f.next),f.value}};b.prototype._unlink=function(h,f,d){this.length--;0===this.length?this.head=this.tail=null:this.head===h?(this.head=f,this.cache[this.head].next=null):this.tail===h?(this.tail=d,this.cache[this.tail].prev=null):(this.cache[f].next=d,this.cache[d].prev=f)};b.prototype.peek=function(h){if(this.cache.hasOwnProperty(h)){var f=this.cache[h];if(this._checkAge(h,f))return f.value}};b.prototype.set=
function(h,f){"string"!=typeof h&&(h=""+h);var d;if(this.cache.hasOwnProperty(h)){if(d=this.cache[h],d.value=f,this.maxAge&&(d.modified=Date.now()),h===this.head)return f;this._unlink(h,d.prev,d.next)}else d={value:f,modified:0,next:null,prev:null},this.maxAge&&(d.modified=Date.now()),this.cache[h]=d,this.length===this.max&&this.evict();return this.length++,d.next=null,d.prev=this.head,this.head&&(this.cache[this.head].next=h),this.head=h,this.tail||(this.tail=h),f};b.prototype._checkAge=function(h,
f){return this.maxAge&&Date.now()-f.modified>this.maxAge?(this.remove(h),!1):!0};b.prototype.get=function(h){if("string"!=typeof h&&(h=""+h),this.cache.hasOwnProperty(h)){var f=this.cache[h];if(this._checkAge(h,f))return this.head!==h&&(h===this.tail?(this.tail=f.next,this.cache[this.tail].prev=null):this.cache[f.prev].next=f.next,this.cache[f.next].prev=f.prev,this.cache[this.head].next=h,f.prev=this.head,f.next=null,this.head=h),f.value}};b.prototype.evict=function(){!this.tail||this.remove(this.tail)}}),
db=z((a,c)=>{function b(e,g,k){f.ok(this instanceof b,"ChooComponentCache should be created with `new`");f.equal(typeof e,"object","ChooComponentCache: state should be type object");f.equal(typeof g,"function","ChooComponentCache: emit should be type function");"number"==typeof k?this.cache=new d(k):this.cache=k||new d(100);this.state=e;this.emit=g}function h(e){return new (e.bind.apply(e,arguments))}var f=D(),d=cb();c.exports=b;b.prototype.render=function(e,g){f.equal(typeof e,"function","ChooComponentCache.render: Component should be type function");
f.ok("string"==typeof g||"number"==typeof g,"ChooComponentCache.render: id should be type string or type number");var k=this.cache.get(g);if(!k){k=[];for(var n=2,m=arguments.length;n<m;n++)k.push(arguments[n]);k.unshift(e,g,this.state,this.emit);k=h.apply(h,k);this.cache.set(g,k)}return k}}),eb=z((a,c)=>{function b(r){var p=d("choo.constructor");if(!(this instanceof b))return new b(r);r=r||{};q.equal(typeof r,"object","choo: opts should be type object");var t=this;this._events={DOMCONTENTLOADED:"DOMContentLoaded",
DOMTITLECHANGE:"DOMTitleChange",REPLACESTATE:"replaceState",PUSHSTATE:"pushState",NAVIGATE:"navigate",POPSTATE:"popState",RENDER:"render"};this._historyEnabled=void 0===r.history?!0:r.history;this._hrefEnabled=void 0===r.href?!0:r.href;this._hashEnabled=void 0===r.hash?!1:r.hash;this._hasWindow="undefined"!=typeof window;this._cache=r.cache;this._loaded=!1;this._stores=[function(w){t.emitter.prependListener(t._events.DOMTITLECHANGE,function(x){q.equal(typeof x,"string","events.DOMTitleChange: title should be type string");
w.title=x;t._hasWindow&&(document.title=x)})}];this._tree=null;r={events:this._events,components:{}};this._hasWindow?(this.state=window.initialState?Object.assign({},window.initialState,r):r,delete window.initialState):this.state=r;this.router=e({curry:!0});this.emitter=l("choo.emit");this.emit=this.emitter.emit.bind(this.emitter);this._hasWindow&&(this.state.title=document.title);p()}var h=Pa(),f=Qa(),d=la(),e=Ua(),g=Xa(),k=Ya(),n=Za(),m=$a(),l=bb(),q=D(),v=db();c.exports=b;var u={};b.prototype.route=
function(r,p){var t=d("choo.route('"+r+"')");q.equal(typeof r,"string","choo.route: route should be type string");q.equal(typeof p,"function","choo.handler: route should be type function");this.router.on(r,p);t()};b.prototype.use=function(r){q.equal(typeof r,"function","choo.use: cb should be type function");var p=this;this._stores.push(function(t){var w="choo.use";w=r.storeName?w+"("+r.storeName+")":w;w=d(w);r(t,p.emitter,p);w()})};b.prototype.start=function(){q.equal(typeof window,"object","choo.start: window was not found. .start() must be called in a browser, use .toString() if running in Node");
var r=d("choo.start"),p=this;return this._historyEnabled&&(this.emitter.prependListener(this._events.NAVIGATE,function(){p._matchRoute(p.state);p._loaded&&(p.emitter.emit(p._events.RENDER),setTimeout(h.bind(null,window.location.hash),0))}),this.emitter.prependListener(this._events.POPSTATE,function(){p.emitter.emit(p._events.NAVIGATE)}),this.emitter.prependListener(this._events.PUSHSTATE,function(t){q.equal(typeof t,"string","events.pushState: href should be type string");window.history.pushState(u,
null,t);p.emitter.emit(p._events.NAVIGATE)}),this.emitter.prependListener(this._events.REPLACESTATE,function(t){q.equal(typeof t,"string","events.replaceState: href should be type string");window.history.replaceState(u,null,t);p.emitter.emit(p._events.NAVIGATE)}),window.onpopstate=function(){p.emitter.emit(p._events.POPSTATE)},p._hrefEnabled&&n(function(t){var w=t.href;t=t.hash;w===window.location.href?!p._hashEnabled&&t&&h(t):p.emitter.emit(p._events.PUSHSTATE,w)})),this._setCache(this.state),this._matchRoute(this.state),
this._stores.forEach(function(t){t(p.state)}),this._tree=this._prerender(this.state),q.ok(this._tree,"choo.start: no valid DOM node returned for location "+this.state.href),this.emitter.prependListener(p._events.RENDER,m(function(){var t=d("choo.render"),w=p._prerender(p.state);q.ok(w,"choo.render: no valid DOM node returned for location "+p.state.href);q.equal(p._tree.nodeName,w.nodeName,"choo.render: The target node <"+p._tree.nodeName.toLowerCase()+"> is not the same type as the new node <"+w.nodeName.toLowerCase()+
">.");var x=d("choo.morph");g(p._tree,w);x();t()})),f(function(){p.emitter.emit(p._events.DOMCONTENTLOADED);p._loaded=!0}),r(),this._tree};b.prototype.mount=function(r){var p=d("choo.mount('"+r+"')");if("object"!=typeof window)return q.ok("string"==typeof r,"choo.mount: selector should be type String"),this.selector=r,p(),this;q.ok("string"==typeof r||"object"==typeof r,"choo.mount: selector should be type String or HTMLElement");var t=this;f(function(){var w=d("choo.render"),x=t.start();"string"==
typeof r?t._tree=document.querySelector(r):t._tree=r;q.ok(t._tree,"choo.mount: could not query selector: "+r);q.equal(t._tree.nodeName,x.nodeName,"choo.mount: The target node <"+t._tree.nodeName.toLowerCase()+"> is not the same type as the new node <"+x.nodeName.toLowerCase()+">.");var C=d("choo.morph");g(t._tree,x);C();w()});p()};b.prototype.toString=function(r,p){p=p||{};p.components=p.components||{};p.events=Object.assign({},p.events,this._events);q.notEqual(typeof window,"object","choo.mount: window was found. .toString() must be called in Node, use .start() or .mount() if running in the browser");
q.equal(typeof r,"string","choo.toString: location should be type string");q.equal(typeof p,"object","choo.toString: state should be type object");this._setCache(p);this._matchRoute(p,r);this.emitter.removeAllListeners();this._stores.forEach(function(w){w(p)});var t=this._prerender(p);return q.ok(t,"choo.toString: no valid value returned for the route "+r),q(!Array.isArray(t),"choo.toString: return value was an array for the route "+r),"string"==typeof t.outerHTML?t.outerHTML:t.toString()};b.prototype._matchRoute=
function(r,p){var t,w;p?(t=p.replace(/\?.+$/,"").replace(/\/$/,""),this._hashEnabled||(t=t.replace(/#.+$/,"")),w=p):(t=window.location.pathname.replace(/\/$/,""),this._hashEnabled&&(t+=window.location.hash.replace(/^#/,"/")),w=window.location.search);p=this.router.match(t);this._handler=p.cb;r.href=t;r.query=k(w);r.route=p.route;r.params=p.params};b.prototype._prerender=function(r){var p=d("choo.prerender('"+r.route+"')");r=this._handler(r,this.emit);return p(),r};b.prototype._setCache=function(r){function p(w,
x){q.equal(typeof w,"function","choo.state.cache: Component should be type function");for(var C=[],A=0,y=arguments.length;A<y;A++)C.push(arguments[A]);return t.render.apply(t,C)}var t=new v(r,this.emitter.emit.bind(this.emitter),this._cache);r.cache=p;p.toJSON=function(){return null}}}),P=E(()=>{}),Q,ma=E(()=>{Q=(a,c,b={})=>{function h(n,m){if(n.preventDefault(),!confirm("Permanently delete image from all pages in wiki?"))return!1;delete a.p.img[m.id];0<m.pgs.length&&(a.p.pages=a.p.pages.map(l=>(l.content&&
(l.content=l.content.replaceAll(`<img src="img:${m.id}:img">`,"")),l)));c(f.CHECK_CHANGED)}let {events:f,root:d}=a,{showDelete:e=!1,showUsed:g=!1,insert:k=null}=b;b=function(){let {pages:n,img:m}=a.p;return Object.keys(m).map(l=>O(L({id:l},m[l]),{pgs:g?n.filter(q=>{var v;return null==(v=q.content)?void 0:v.includes(`img:${l}:img`)}):[]}))}();return html`<section> <h1>Existing Images</h1> ${b.map(n=>html`<div class="ib at ed w14"> <div class=g> <img src=${n.img} class=w1 aria-describedby=alt> <span id=alt class=db>${n.alt} (${n.size[0]}x${n.size[1]}px)</span> <div class=pb> <button onclick=${m=>
{var l=n.img;m.preventDefault();m=new Image;m.src=l;window.open("").document.write(m.outerHTML)}}>View</button> ${e?html`<button onclick=${m=>{m.preventDefault();a.p.img[n.id].alt=prompt("Set alt text",n.alt);c(f.CHECK_CHANGED)}}>Edit Alt</button>`:""} ${e?html`<button class=del onclick=${m=>h(m,n)}>Delete</button>`:""} ${k?html`<button onclick=${m=>k(m,n)}>Insert</button>`:""} </div> ${g?[html`<details> <summary>Used in ${n.pgs.length} pages</summary> <ul> ${n.pgs.map(m=>html`<li><a href="${d}?page=${m.slug}">${m.name}</a></li>`)} </ul> </details>`]:
""} </div> </div>`)}  </section>`}}),na=E(()=>{}),fb=z((a,c)=>{c.exports=function(b){var h=document.createElement("div");h.innerHTML=b;b=h.childNodes;return Array.isArray(b)?b:[].slice.call(b)}}),gb=z((a,c)=>{c.exports=fb()}),U,hb=E(()=>{U={"":["<em>","</em>"],_:["<strong>","</strong>"],"*":["<strong>","</strong>"],"~":["<s>","</s>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]}}),oa={};ha(oa,{default:()=>sa});var ib=E(()=>{hb()}),jb=E(()=>{na();P()}),pa={};ha(pa,{editor:()=>qa});var qa,kb=E(()=>
{ma();jb();qa=a=>{function c({id:h}){h=`![](img:${h}:img)`;if(document.activeElement!==b&&b.focus(),document.selection)document.selection.createRange().text=h;else if(b.selectionStart||0===b.selectionStart){var f=b.selectionStart,d=b.selectionEnd;b.value=b.value.substring(0,f)+h+b.value.substring(d,b.value.length);b.selectionStart=f+h.length;b.selectionEnd=f+h.length}else b.value+=h;a.edits.content=b.value}let b=html`<textarea onchange=${h=>a.edits.content=h.target.value}>${a.edits.content}</textarea>`;
return[b,html`<button onclick=${h=>{h.preventDefault();ta(a,c)}}>Insert Image from File</button>`,html`<button onclick=${h=>{h.preventDefault();document.getElementById("g").showModal()}}>Add Existing Image</button>`,html`<dialog id=g> <form class=fr method=dialog> <button>Close</button> </form> ${Q(a,()=>{},{insert:(h,f)=>va(h,f,c)})} </dialog>`]}}),lb=z((a,c)=>{c.exports=function(h){return function(f,d,e){for(var g in d)g in b&&(d[b[g]]=d[g],delete d[g]);return h(f,d,e)}};var b={class:"className",
for:"htmlFor","http-equiv":"httpEquiv"}}),mb=z((a,c)=>{var b=lb();c.exports=function(f,d){function e(k){return"function"==typeof k||"string"==typeof k||k&&"object"==typeof k||null==k?k:g("",k)}d||={};var g=d.concat||function(k,n){return String(k)+String(n)};return!1!==d.attrToProp&&(f=b(f)),function(k){function n(C){var A=[];7===m&&(m=4);for(var y=0;y<C.length;y++){var B=C.charAt(y);1===m&&"<"===B?(l.length&&A.push([1,l]),l="",m=2):">"===B&&9!==m&&10!==m&&13!==m?(2===m&&l.length?A.push([2,l]):5===
m?A.push([5,l]):8===m&&l.length&&A.push([8,l]),A.push([3]),l="",m=1):13===m&&/-$/.test(l)&&"-"===B?(d.comments&&A.push([8,l.substr(0,l.length-1)]),l="",m=1):2===m&&/^!--$/.test(l)?(d.comments&&A.push([2,l],[5,"comment"],[11]),l=B,m=13):1===m||13===m?l+=B:2===m&&"/"===B&&l.length||(2===m&&/\s/.test(B)?(l.length&&A.push([2,l]),l="",m=4):2===m?l+=B:4===m&&/[^\s"'=/]/.test(B)?(m=5,l=B):4===m&&/\s/.test(B)?(l.length&&A.push([5,l]),A.push([12])):5===m&&/\s/.test(B)?(A.push([5,l]),l="",m=6):5===m&&"="===
B?(A.push([5,l],[11]),l="",m=7):5===m?l+=B:6!==m&&4!==m||"="!==B?6!==m&&4!==m||/\s/.test(B)?7===m&&'"'===B?m=10:7===m&&"'"===B?m=9:10===m&&'"'===B?(A.push([8,l],[12]),l="",m=4):9===m&&"'"===B?(A.push([8,l],[12]),l="",m=4):7!==m||/\s/.test(B)?8===m&&/\s/.test(B)?(A.push([8,l],[12]),l="",m=4):(8===m||9===m||10===m)&&(l+=B):(m=8,y--):(A.push([12]),/[\w-]/.test(B)?(l+=B,m=5):m=4):(A.push([11]),m=7))}return 1===m&&l.length?(A.push([1,l]),l=""):8===m&&l.length?(A.push([8,l]),l=""):10===m&&l.length?(A.push([8,
l]),l=""):9===m&&l.length?(A.push([8,l]),l=""):5===m&&(A.push([5,l]),l=""),A}for(var m=1,l="",q=arguments.length,v=[],u=0;u<k.length;u++)if(u<q-1){var r=arguments[u+1],p=n(k[u]),t=m;10===t&&(t=8);9===t&&(t=8);7===t&&(t=8);4===t&&(t=5);2===t?"/"===l?(p.push([2,"/",r]),l=""):p.push([2,r]):13===t&&d.comments?l+=String(r):13!==t&&p.push([0,t,r]);v.push.apply(v,p)}else v.push.apply(v,n(k[u]));q=[null,{},[]];r=[[q,-1]];for(u=0;u<v.length;u++){t=r[r.length-1][0];p=v[u];var w=p[0];if(2===w&&/^\//.test(p[1]))p=
r[r.length-1][1],1<r.length&&(r.pop(),r[r.length-1][0][2][p]=f(t[0],t[1],t[2].length?t[2]:void 0));else if(2===w)p=[p[1],{},[]],t[2].push(p),r.push([p,t[2].length-1]);else if(5===w||0===w&&5===p[1]){p="";for(var x;u<v.length;u++)if(5===v[u][0])p=g(p,v[u][1]);else if(0===v[u][0]&&5===v[u][1])if("object"!=typeof v[u][2]||p)p=g(p,v[u][2]);else for(x in v[u][2])v[u][2].hasOwnProperty(x)&&!t[1][x]&&(t[1][x]=v[u][2][x]);else break;11===v[u][0]&&u++;for(w=u;u<v.length;u++)if(8===v[u][0]||5===v[u][0])t[1][p]?
""===v[u][1]||(t[1][p]=g(t[1][p],v[u][1])):t[1][p]=e(v[u][1]);else if(0!==v[u][0]||8!==v[u][1]&&5!==v[u][1]){!p.length||t[1][p]||u!==w||3!==v[u][0]&&12!==v[u][0]||(t[1][p]=p.toLowerCase());3===v[u][0]&&u--;break}else t[1][p]?""===v[u][2]||(t[1][p]=g(t[1][p],v[u][2])):t[1][p]=e(v[u][2])}else if(5===w)t[1][p[1]]=!0;else if(0===w&&5===p[1])t[1][p[2]]=!0;else if(3===w)h.test(t[0])&&r.length&&(p=r[r.length-1][1],r.pop(),r[r.length-1][0][2][p]=f(t[0],t[1],t[2].length?t[2]:void 0));else if(0===w&&1===p[1])void 0===
p[2]||null===p[2]?p[2]="":p[2]||(p[2]=g("",p[2])),Array.isArray(p[2][0])?t[2].push.apply(t[2],p[2]):t[2].push(p[2]);else if(1===w)t[2].push(p[1]);else if(11!==w&&12!==w)throw Error("unhandled: "+w);}if(1<q[2].length&&/^\s*$/.test(q[2][0])&&q[2].shift(),2<q[2].length||2===q[2].length&&/\S/.test(q[2][1])){if(d.createFragment)return d.createFragment(q[2]);throw Error("multiple root elements must be wrapped in an enclosing tag");}return Array.isArray(q[2][0])&&"string"==typeof q[2][0][0]&&Array.isArray(q[2][0][2])&&
(q[2][0]=f(q[2][0][0],q[2][0][1],q[2][0][2])),q[2][0]}};var h=RegExp("^(area|base|basefont|bgsound|br|col|command|embed|frame|hr|img|input|isindex|keygen|link|meta|param|source|track|wbr|!--|animate|animateTransform|circle|cursor|desc|ellipse|feBlend|feColorMatrix|feComposite|feConvolveMatrix|feDiffuseLighting|feDisplacementMap|feDistantLight|feFlood|feFuncA|feFuncB|feFuncG|feFuncR|feGaussianBlur|feImage|feMergeNode|feMorphology|feOffset|fePointLight|feSpecularLighting|feSpotLight|feTile|feTurbulence|font-face-format|font-face-name|font-face-uri|glyph|glyphRef|hkern|image|line|missing-glyph|mpath|path|polygon|polyline|rect|set|stop|tref|use|view|vkern)(?:[.#][a-zA-Z0-9\u007f-\uffff_:-]+)*$")}),
nb=z((a,c)=>{var b=/\n[\s]+$/,h=/^\n[\s]+/,f=/[\s]+$/,d=/^[\s]+/,e=/[\n\s]+/g,g="a abbr b bdi bdo br cite data dfn em i kbd mark q rp rt rtc ruby s amp small span strong sub sup time u var wbr".split(" "),k=["code","pre","textarea"];c.exports=function q(m,l){if(Array.isArray(l))for(var v=m.nodeName.toLowerCase(),u=!1,r,p,t=0,w=l.length;t<w;t++){var x=l[t];if(Array.isArray(x))q(m,x);else{("number"==typeof x||"boolean"==typeof x||"function"==typeof x||x instanceof Date||x instanceof RegExp)&&(x=x.toString());
var C=m.childNodes[m.childNodes.length-1];"string"==typeof x?(u=!0,C&&"#text"===C.nodeName?C.nodeValue+=x:(x=m.ownerDocument.createTextNode(x),m.appendChild(x),C=x),t===w-1&&(u=!1,-1===g.indexOf(v)&&-1===k.indexOf(v)?(r=C.nodeValue.replace(h,"").replace(f,"").replace(b,"").replace(e," "),""===r?m.removeChild(C):C.nodeValue=r):-1===k.indexOf(v)&&(p=0===t?"":" ",r=C.nodeValue.replace(h,p).replace(d," ").replace(f,"").replace(b,"").replace(e," "),C.nodeValue=r))):x&&x.nodeType&&(u&&(u=!1,-1===g.indexOf(v)&&
-1===k.indexOf(v)?(r=C.nodeValue.replace(h,"").replace(b," ").replace(e," "),""===r?m.removeChild(C):C.nodeValue=r):-1===k.indexOf(v)&&(r=C.nodeValue.replace(d," ").replace(h,"").replace(b," ").replace(e," "),C.nodeValue=r)),(C=x.nodeName)&&(v=C.toLowerCase()),m.appendChild(x))}}}}),ob=z((a,c)=>{c.exports="svg altGlyph altGlyphDef altGlyphItem animate animateColor animateMotion animateTransform circle clipPath color-profile cursor defs desc ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font font-face font-face-format font-face-name font-face-src font-face-uri foreignObject g glyph glyphRef hkern image line linearGradient marker mask metadata missing-glyph mpath path pattern polygon polyline radialGradient rect set stop switch symbol text textPath title tref tspan use view vkern".split(" ")}),
pb=z((a,c)=>{c.exports="async autofocus autoplay checked controls default defaultchecked defer disabled formnovalidate hidden ismap loop multiple muted novalidate open playsinline readonly required reversed selected".split(" ")}),qb=z((a,c)=>{c.exports=["indeterminate"]}),rb=z((a,c)=>{var b=mb(),h=nb(),f=ob(),d=pb(),e=qb();c.exports=function(g){function k(l,q,v){var u;-1!==f.indexOf(l)&&(q.namespace="http://www.w3.org/2000/svg");var r=!1;q.namespace&&(r=q.namespace,delete q.namespace);var p=!1;if(q.is&&
(p=q.is,delete q.is),r)p?u=g.createElementNS(r,l,{is:p}):u=g.createElementNS(r,l);else{if("!--"===l)return g.createComment(q.comment);p?u=g.createElement(l,{is:p}):u=g.createElement(l)}for(var t in q)if(q.hasOwnProperty(t)){l=t.toLowerCase();p=q[t];if("classname"===l&&(l="class",t="class"),"htmlFor"===t&&(t="for"),-1!==d.indexOf(l))if("true"===String(p))p=l;else if("false"===String(p))continue;"on"===l.slice(0,2)||-1!==e.indexOf(l)?u[t]=p:r?"xlink:href"===t?u.setAttributeNS("http://www.w3.org/1999/xlink",
t,p):/^xmlns($|:)/i.test(t)||u.setAttributeNS(null,t,p):u.setAttribute(t,p)}return h(u,v),u}function n(l){for(var q=g.createDocumentFragment(),v=0;v<l.length;v++)null!=l[v]&&(Array.isArray(l[v])?q.appendChild(n(l[v])):("string"==typeof l[v]&&(l[v]=g.createTextNode(l[v])),q.appendChild(l[v])));return q}var m=b(k,{comments:!0,createFragment:n});return m.default=m,m.createComment=k,m}}),sb=z((a,c)=>{c.exports=rb()(document)}),Ha=z((a,c)=>{c.exports=sb()}),tb=ja(eb(),1);P();var I=-1,ub=(a,c)=>{function b(d){let e=
f.getChildren(d);return html`<li> <a href="?page=${d.slug}">${d.name}</a> ${0<e.length?html`<ul>${e.map(g=>b(g))}</ul>`:""} </li>`}let {p:h,help:f}=a;return[html`<header> <h1>All Pages</h1> </header>`,html`<article> <p>This wiki has ${h.pages.length} page${1!==h.pages.length?"s":""}:</p> <ul> ${h.pages.filter(d=>!d.parent).map(d=>b(d))} </ul> </article>`]};ma();na();var vb=(a,c)=>{function b(){S("text/html",l=>{xa(l,q=>{q&&(a.p=q[0],h(q[1]),f(q[2]),c(e.DOMCONTENTLOADED),c(e.CHECK_CHANGED),c(e.NOTIFY,
"Wiki Loaded"))})})}function h(l){let q=document.getElementById("c");l.trim()?(a.c=l,q?q.innerHTML=l:document.head.innerHTML+=`<style id=c>${l}</style>`):(delete a.c,q&&document.head.removeChild(q))}function f(l){l.trim()?(a.j=l,alert("You must save & reload to run your JavaScript")):delete a.j}var d;let {events:e,p:g,c:k,j:n}=a,m=g.pages.map(l=>l.slug).join("\n");return[html`<header> <h1>Wiki Settings</h1> </header>`,html`<article class=mw> <form onsubmit=${(function(l){l.preventDefault();l=l.currentTarget;
let q=l.wTitle.value.trim();if(1>q.length)return alert("Title is required");a.p.name=q;a.p.desc=l.wDesc.value.trim();1<l.home.value.length?a.p.home=l.home.value:delete a.p.home;let v=l.wPo.value.split("\n").map(u=>u.trim());a.p.pages.sort((u,r)=>v.indexOf(u.slug)<v.indexOf(r.slug)?-1:1);h(l.wCss.value);f(l.wJs.value);a.p.published=l.wPub.checked;c(e.CHECK_CHANGED);c(e.NOTIFY,"Settings updated")})} class=pb> <div class=r> <label class="c tr ml w14" for=wTitle>Wiki Title</label> <div class="c w34"> <input class=w1 id=wTitle value=${g.name} minlength=1 required> </div> </div> <div class=r> <label class="c tr ml w14" for=wDesc>Wiki Description</label> <div class="c w34"> <input class=w1 id=wDesc value=${g.desc}> </div> </div> <div class=r> <label class="c tr ml w14" for=home>Home Page</label> <div class="c w34"> <select id=home> <option value="" selected=${!g.home}>All Pages (default)</option> ${g.pages.map(l=>
html`<option selected=${l.id===g.home} value=${l.id}>${l.name} (${l.slug})</option>`)} </select> </div> </div> <div class=r> <label class="c tr ml w14" for=wPo>Page Order</label> <div class="c w34"> <textarea id=wPo>${m}</textarea> </div> </div> <div class=r> <label class="c tr ml w14" for=wCss>Custom CSS</label> <div class="c w34"> <textarea id=wCss>${k}</textarea> </div> </div> <div class=r> <label class="c tr ml w14" for=wJs>Custom JS</label> <div class="c w34"> <span class=h>Only runs once on wiki load. To test, save your wiki & load that file.</span> <textarea id=wJs>${n}</textarea> </div> </div> <div class=r> <label class="c tr ml w14" for=wPub>Publish</label> <div class="c w34"> <input id=wPub type=checkbox checked=${null!=
(d=g.published)?d:!1}> <span class=h>Hides Save, New Page, & Wiki Settings buttons. You will need to manually visit <code>?page=s</code> to unset this when set.</span> </div> </div> <div class=tr> <button type=submit>Update</button> </div> </form> <div class=tr> <p class="pb h"> Feather Wiki Version: Bluethroat_1.3.0 </p> <p> <button class=del onclick=${()=>b()}>Import & Overwrite with Other Feather Wiki file</button> </p> </div> ${Q(a,c,{showDelete:!0,
showUsed:!0})} </article>`]},wb=(a,c)=>{let {p:b,query:h}=a;a=b.pages.filter(f=>{var d;return null==(d=f.tags)?void 0:d.includes(h.tag)});return[html`<header> <h1>Pages Tagged <code>${h.tag}</code></h1> </header>`,html`<article> ${0<a.length?html`<ul> ${a.map(f=>html`<li><a href="?page=${f.slug}">${f.name}</a></li>`)} </ul>`:"None Found"} </article>`]},F=a=>a.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"-"),ra=a=>`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,
"0")} ${a.getHours()%12}:${a.getMinutes().toString().padStart(2,"0")} ${1>a.getHours()/12?"a":"p"}m`,R=a=>{let c=a.map(b=>b.trim());return c.filter((b,h)=>b.length&&c.indexOf(b)===h).sort()},xb=ja(gb(),1),yb=(a,c,b)=>{var h;let {root:f,help:d}=a,{content:e}=b;c=e;c="md"===b.editor?(ib(),ka(oa)).default(e):e;c=Aa(za(Ca(Ba(c)),a),a);a=d.getChildren(b);return[null!=b&&b.e||null==(h=null==b?void 0:b.tags)||!h.length?"":html`<aside> <dl class="db r"> <dt class=c><b>Tagged:</b></dt> <dd class=c> ${b.tags.replace(/,/g,
", ")} </dd> </dl> </aside>`,html`<article class=uc> ${c?(0,xb.default)(c):"No Page Content"} </article>`,0<a.length?html`<footer> <h2>Sub Pages</h2> <ul> ${a.map(g=>html`<li><a href="${f}?page=${g.slug}">${g.name}</a></li>`)} </ul> </footer>`:null]},zb=(a,c,b)=>{function h(m){m=m.target;a.edits[m.id]=m.value;c(a.events.RENDER)}let {edits:f,p:d,help:e}=a,g=e.getChildren(b).map(m=>m.id),k=!d.pages.some(m=>m.id===b.id),n;return n=(kb(),ka(pa)).editor(a,c),html`<form onsubmit=${(function(m){m.preventDefault();
m=m.currentTarget;let l=m.name.value.trim();if(1>l.length)return alert("Page Title cannot be blank.");let q=m.slug.value.trim();if(2>q.length)return alert("Page Slug must be more than 1 character long.");pg=L({},b);pg.name=l;pg.slug=F(q);pg.content=a.edits.content.replace(/(?:<img src=")[^"]+#([-\d]+)(?=")/g,'<img src="img:$1:img');pg.tags=R(document.getElementById("tags").value.split(",")).join(",");pg.parent=m.parent.value;f.useMd?pg.editor="md":delete pg.editor;c(a.events.UPDATE_PAGE,pg)})}> <header> <h1>Edit Page</h1> <div class=r> <div class="c w12"> <label for=name>Page Title</label> <input id=name value=${f.name} required minlength=2 onchange=${h}> </div> <div class="c w12"> <label for=slug>Page Slug</label> <input id=slug value=${f.slug} required minlength=2 onchange=${h}> <button onclick=${(function(m){m.preventDefault();
document.getElementById("slug").value=F(document.getElementById("name").value.trim())})}>Slugify Title</button> </div> </div></header> <span class=h style=float:left>Use [[Page Title]] or [[text|page_slug]] for internal links.</span> ${n} <footer class=r> <div class="c w13"> <label for=tags>Page Tags</label> <input id=tags value=${f.tags} placeholder="Comma, Separated, List" onchange=${h}> <select onchange=${(function(m){let l=m.target.value;if(0<l.length){let q=R(document.getElementById("tags").value.split(","));
q.includes(l)||(f.tags+=(0<q.length?",":"")+l,c(a.events.RENDER))}m.target.value=""})}> <option value="" selected=selected disabled=disabled>Add Existing Tag</option> ${a.t.filter(m=>!f.tags.split(",").includes(m)).map(m=>html`<option>${m}</option>`)} </select> </div> <div class="c w13"> <label for=parent>Parent</label> <select id=parent onchange=${h}> <option value="" selected=${""===f.parent}>None</option> ${d.pages.filter(m=>m.id!==(null==b?void 0:b.id)&&!g.includes(m.id)).map(m=>html`<option selected=${m.id===
f.parent} value=${m.id}>${m.name} (${m.slug})</option>`)} </select> </div> <div class="c w13 tr"> <div class=pb><button type=submit>Save</button></div> ${k?"":html`<div><button class=del onclick=${m=>{m.preventDefault();confirm("You can't undo this after saving your wiki! Delete this page?")&&c(a.events.DELETE_PAGE,b.id)}}>Delete</button></div>`} </div> </footer> </form>`},Ab=(a,c,b)=>{let {edit:h,p:f,events:d}=a,{cd:e,md:g}=b;if(h)return zb(a,c,b);let k=a.help.breadcrumb(b),n=ra(new Date(e)),m=new Date(null!=
g?g:e),l=ra(m);return[html`<header> ${k.map(q=>[html`<a href="${a.root}?page=${q.slug}">${q.name}</a>`," / "])} <div class="r ns"> <h1 class=c>${b.name}</h1> ${b.e?"":html`<div class="c w14 tr"> <time datetime=${m.toISOString()}> ${n!==l?html`<abbr title="Created: ${n}">${l}</abbr>`:l} </time> ${f.published?"":html`<button onclick=${()=>c(d.START_EDIT)}>Edit</button> `} </div>`} </div> </header>`,yb(a,c,b)]},Ea=a=>{var c,b,h,f;a.root=location.pathname;1>a.root.length&&(a.root="/");a.sb=!1;a.sbTab=
"Pages";a.recent=[];a.edit=!1;a.edits=null;a.keep=!1;a.src=!1;a.notis=[];a.canSave=!1;a.help={find:(d,e="slug")=>a.p.pages.find(g=>g[e]===d),getPage:()=>{let {query:d,help:e,p:g}=a;return!d.page&&g.home?e.find(g.home,"id"):e.find(d.page)},getParent:d=>a.p.pages.find(e=>e.id===(null==d?void 0:d.parent)),getChildren:d=>a.p.pages.filter(e=>e.parent===(null==d?void 0:d.id)),breadcrumb:d=>{let e=[];for(d=a.help.getParent(d);d;)e.push(d),d=a.help.getParent(d);return e}};a.events=O(L({},a.events),{HANDLE_404:"404",
CREATE_PAGE:"cp",START_EDIT:"se",UPDATE_PAGE:"up",DELETE_PAGE:"dp",COLLECT_TAGS:"ct",CHECK_CHANGED:"cc",SAVE_WIKI:"sw",NOTIFY:"n",REMOVE_NOTI:"rn"});a.events=O(L({},a.events),{PUT_SAVE_WIKI:"psw",DETECT_PUT_SUPPORT:"dps"});a.views={a:ub,s:vb,t:wb,p:Ab};a.a=document.getElementById("a").innerHTML;a.s=document.getElementById("s").innerHTML;a.c=null!=(b=null==(c=document.getElementById("c"))?void 0:c.innerHTML)?b:"";a.j=null!=(f=null==(h=document.getElementById("j"))?void 0:h.innerHTML)?f:"";try{a.p=
M(JSON.parse(document.getElementById("p").innerHTML))}catch(d){a.p={name:"New Wiki",desc:"",pages:[],img:{}}}return a.pg=a.help.getPage(),a.t=[],a.prev=G(JSON.stringify(a.p)),a.now=a.prev,a.changed=!1,a};P();var Fa=(a,c)=>{let {events:b,views:h}=a,f=()=>c.emit(...[b.DOMTITLECHANGE,a.p.name+(a.pg?" | "+a.pg.name:"")]);return c.on(b.DOMCONTENTLOADED,()=>{c.emit(...[b.HANDLE_404]);f();c.emit(...[b.COLLECT_TAGS]);a.t.length&&c.emit(...[b.RENDER]);c.emit(...[b.DETECT_PUT_SUPPORT])}),c.on(b.RENDER,d=>{"function"==
typeof d&&setTimeout(d,100)}),c.on(b.HANDLE_404,()=>{var {page:d}=a.query;if(1<(null==d?void 0:d.length)){let {help:e,events:g}=a,k=F(d);e.find(k)||h[k]||(d=d.split("_").map(n=>n[0].toUpperCase()+n.substring(1)).join(" "),c.emit(...[g.CREATE_PAGE,d,!1]))}else 0<(null==d?void 0:d.length)&&!h[d]&&(a.pg={e:!0,name:"404",content:"<p>Page not found</p>"},c.emit(...[b.RENDER]))}),c.on(b.NAVIGATE,()=>{var d;if(!a.keep&&a.edits&&!confirm("Lose unsaved changes?"))return a.keep=!0,history.go(-1);a.keep?a.keep=
!1:(a.edit=!1,a.edits=null,a.pg=a.help.getPage(),a.recent=[{p:null==(d=a.pg)?void 0:d.id,t:Date.now()},...a.recent.filter(e=>{var g;return e.p!==(null==(g=a.pg)?void 0:g.id)})].filter(e=>!!e.p),c.emit(...[b.HANDLE_404]),f(),window.scroll(0,0))}),c.on(b.CREATE_PAGE,(d,e=!0)=>{if(!(2>d.length||a.edits&&!confirm("Lose unsaved changes?"))){a.edit=!1;a.edits=null;var {p:g,events:k,query:n,root:m}=a,l=()=>{let r=[];for(let p=0;9>p;p++)r.push(String.fromCharCode(Math.round(94*Math.random())+32));return r.join("")};
do var q=l();while(0<=g.pages.findIndex(r=>r.id===q));l=0;var v=F(d);do{var u=v+(0<l?"_"+l:"");l++}while(g.pages.some(r=>r.slug===u));d={id:q,name:d,slug:u,cd:Date.now()};a.showNewPageField=!1;e?(a.p.pages.push(d),c.emit(...[k.CHECK_CHANGED]),c.emit(...[k[n.page!==u?"REPLACESTATE":"PUSHSTATE"],m+"?page="+u])):a.pg=d;c.emit(...[k.START_EDIT])}}),c.on(b.START_EDIT,()=>{var d,e,g,k,n;let {pg:m}=a;a.edit=!0;let l={name:null!=(d=m.name)?d:"",slug:null!=(e=m.slug)?e:"",content:null!=(g=m.content)?g:"",
tags:null!=(k=m.tags)?k:"",parent:null!=(n=m.parent)?n:"",useMd:!0};a.edits=l;a.src=!1;c.emit(...[b.RENDER])}),c.on(b.UPDATE_PAGE,d=>{let {p:e}=a;if(e.pages.some(k=>k.slug===d.slug&&k.id!==d.id))return alert('A page with the slug "'+d.slug+'" already exists!');let g=e.pages.findIndex(k=>k.id===d.id);Object.keys(d).forEach(k=>{1>d[k].length&&delete d[k]});d.md=Date.now();-1<g?e.pages[g]=d:e.pages.push(d);a.edit=!1;a.edits=null;a.useMd="md"===d.editor;c.emit(...[b.COLLECT_TAGS]);c.emit(...[b.PUSHSTATE,
a.root+"?page="+d.slug]);c.emit(...[b.CHECK_CHANGED])}),c.on(b.DELETE_PAGE,d=>{a.p.pages=a.p.pages.map(e=>(e.parent===d&&delete e.parent,e)).filter(e=>e.id!==d);a.edit=!1;a.edits=null;c.emit(...[b.COLLECT_TAGS]);c.emit(...[b.PUSHSTATE,a.root]);c.emit(...[b.CHECK_CHANGED])}),c.on(b.COLLECT_TAGS,()=>{a.t=R(a.p.pages.reduce((d,e)=>{var g,k;return[...d,...(null!=(k=null==(g=e.tags)?void 0:g.split(","))?k:[])]},[]))}),c.on(b.CHECK_CHANGED,d=>{a.now=G(JSON.stringify(a.p));a.changed=a.prev!==a.now;c.emit(...[b.RENDER,
d])}),c.on(b.NOTIFY,(d,e=5E3,g="background:#ddd; color:#000")=>{let k=G(d+g+(a.notis.length+1));d={text:d,css:g,id:k,t:0<e?setTimeout(()=>c.emit(...[b.REMOVE_NOTI,k]),e):null};a.notis.push(d);c.emit(...[b.RENDER])}),c.on(b.REMOVE_NOTI,d=>{a.notis.splice(a.notis.findIndex(e=>e.id===d),1);c.emit(...[b.RENDER])}),c.on(b.SAVE_WIKI,()=>{let d=ca(a);var {root:e}=a;e=/\/$/.test(e)?"index.html":e.substring(e.lastIndexOf("/")+1);let g=document.createElement("a");g.setAttribute("href","data:text/html;charset=utf-8,"+
encodeURIComponent(d));g.setAttribute("download",e);document.body.appendChild(g);g.click();document.body.removeChild(g)}),c.on(b.PUT_SAVE_WIKI,()=>{let d=ca(a),{p:e,root:g}=a;fetch(g,{method:"PUT",body:d}).then(k=>k.text().then(n=>({ok:k.ok,status:k.status,text:n}))).then(k=>{if(!k.ok)throw k.text?k.text:`Status ${k.status}.`;c.emit(...[b.NOTIFY,"Saved."]);a.prev=G(JSON.stringify(e));c.emit(b.CHECK_CHANGED)}).catch(k=>{c.emit(...[b.NOTIFY,`Save failed! ${k}`,9999,"background:#e88"])})}),c.on(b.DETECT_PUT_SUPPORT,
()=>{!location.protocol.startsWith("http")||fetch(a.root,{method:"OPTIONS"}).then(d=>{d.ok&&d.headers.get("dav")?(a.canSave=!0,c.emit(b.RENDER)):c.emit(...[b.NOTIFY,"Cannot save to server.",9999,"background:#e88"])}).catch(d=>{})}),c},Ga=(a,c)=>{function b(y){y.preventDefault();y=y.currentTarget.np.value.trim();if(2>y.length)return alert("Enter more than 1 character to create a new page.");c(l.CREATE_PAGE,y.trim())}function h(y){a.sbTab=y.target.innerText;c(l.RENDER)}var f,d;let {root:e,pg:g,p:k,
t:n,recent:m,events:l,query:q,changed:v,sb:u,sbTab:r,views:p,notis:t}=a,w=!k.published||"s"===q.page,x=k.pages.filter(y=>!y.parent),C=m.sort((y,B)=>y.t>B.t?-1:1).map(y=>k.pages.find(B=>B.id===y.p)),A=g?p.p(a,c,g):(null!=(d=p[null!=(f=q.page)?f:"a"])?d:()=>{})(a,c);q.tag&&(A=p.t(a,c));f=[v?html`<div>Wiki has changed!</div>`:""];return a.canSave?f=[...f,html`<div><button class=${v?"chg":""} title="Save wiki to ${location.origin}${e}" onclick=${()=>c(l.PUT_SAVE_WIKI)}>Save Wiki to Server</button></div>`,
html`<div><button title="Download wiki in its current state" onclick=${()=>c(l.SAVE_WIKI)}>Save Wiki Locally</button></div>`]:f=[...f,html`<div><button class=${v?"chg":""} title="Download wiki in its current state" onclick=${()=>c(l.SAVE_WIKI)}>Save Wiki</button></div>`],html`<body> <main> <div class=sb> <span class=db><a href=${e} class=t>${k.name}</a></span> ${k.desc?html`<p class=pb>${k.desc}</p>`:""} ${w?f:""} <button class=sbt onclick=${()=>{a.sb=!a.sb;c(l.RENDER)}}>${u?"Hide":"Show"} Menu</button> <nav class=${u?
"":"n"}> ${w?[html`<p><a href="${e}?page=s">Wiki Settings</a></p>`,html`<details class=pb ontoggle=${()=>document.getElementById("np").focus()}> <summary class=np>New Page</summary> <form onsubmit=${b}> <label class=sr for=np>New Page Title</label> <input id=np placeholder="New Page Title" autocomplete=off> <button type=submit>Create</button> </form> </details>`]:""} <div class=tabs> <button class=${"Pages"===r&&"a"} onclick=${h}>Pages</button> ${0<n.length?html`<button class=${"Tags"===r&&"a"} onclick=${h}>Tags</button>`:
""} <button class=${"Recent"===r&&"a"} onclick=${h}>Recent</button> </div> ${"Pages"===r?html`<ul> ${x.map(y=>html`<li><a href="${e}?page=${y.slug}">${y.name}</a></li>`)} <li><a href="${e}?page=a">All Pages</a></li> </ul>`:""} ${"Tags"===r?html`<ul> ${n.map(y=>html`<li><a href="${e}?tag=${y}">${y}</a></li>`)} </ul>`:""} ${"Recent"===r?html`<ol> ${C.map(y=>html`<li><a href="${e}?page=${y.slug}">${y.name}</a></li>`)} </ol>`:""} </nav> </div> <section>${A}</section> </main> <footer> <span class=fr>Powered by <a href=https://feather.wiki title="Version: Bluethroat_1.3.0" target=_blank rel="noopener noreferrer">Feather Wiki</a></span> </footer> <div class=notis> ${t.map(y=>
html`<div class=noti style=${y.css} onclick=${()=>c(l.REMOVE_NOTI,y.id)} title="Click to close"> ${y.text}<span class=fr>\u00d7</span> </div>`)} </div> </body>`};(()=>{let a=(0,tb.default)({hash:!0});Da(a)})()})(); </script> </body> </html> 